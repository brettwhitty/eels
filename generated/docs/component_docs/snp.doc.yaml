---
# Ergatis Component Documentation
# Extracted from source by extract_component_docs.pl
# Source: TIGR/JCVI/IGS Ergatis bioinformatics workflow system
#
# This file preserves ALL documentation, comments, parameter descriptions,
# and structural details from the original Ergatis source files.

component: snp
extracted_at: "2026-02-19T15:39:25"
source_files:
  - workflow/snp-master.ini
  - workflow/snpconf.ini

# Workflow INI: snp-master.ini
workflow_ini_snp-master.ini:
  SNP_Analysis:
    param.command: $;BIN_DIR$;/SNP_Analysis
    param.mumsAlignFile: $;TMP_DIR$;/mums.align
    param.ref_assmbl: $;REF_ASMBL_ID$;
    param.outFile: $;OUTPUT_DIRECTORY$;/$;REF_ASMBL_ID$;_$;NAME$;_$;WFID$;.bsml
  combineMUMS:
    param.command: /usr/local/common/combineMUMs
    arg: -D
    arg: -x
    arg: -e $;COMBINE_MUMS_ERROR_CUTOFF$;
    arg: -W $;TMP_DIR$;/mums.errorsgaps
    arg: $;TMP_DIR$;/$;REF_ASMBL_ID$;.fasta
    arg: $;TMP_DIR$;/tile.tiled_asmbl.fasta
    arg: $;TMP_DIR$;/mums.gaps
    param.stdout: $;TMP_DIR$;/mums.align
  create_checksum:
    # create individual checksums
    param.command: $;BIN_DIR$;/checksum.pl
    param.-f: $;TMP_DIR$;/$;NAME$;_checksum_filelist.txt
    param.-o: $;OUTPUT_DIRECTORY$;/CHECKSUM
  create_checksum_file_list:
    # create list of files to use for checksums
    param.command: $;BIN_DIR$;/create_list_file
    param.--output_list: $;TMP_DIR$;/$;NAME$;_checksum_filelist.txt
    param.--directory: $;OUTPUT_DIRECTORY$;
    param.--regex: "\".*\\.bsml\""
  create_compute_output:
    # make the output directory
    param.command: mkdir
    arg: -p -m 777 $;OUTPUT_DIRECTORY$;
  create_compute_scratch:
    # make the scratch space
    param.command: mkdir
    arg: -p -m 777 $;TMP_DIR$;
  dtd_validation:
    # Perform dtd validation on the snps output 
    param.command: $;BIN_DIR$;/dtdValid.pl
    param.-d: $;SCHEMA_DIR$;/bsml3_1.dtd
    arg: $;OUTPUT_DIRECTORY$;/$;REF_ASMBL_ID$;_$;NAME$;_$;WFID$;.bsml
  empty:
  make_query_fasta:
    # create query fasta data
    param.command: $;BIN_DIR$;/bsml2fasta
    param.--bsml_list: "'$;QUERY_BSML_FILE_LIST$;'"
    param.--output: $;TMP_DIR$;/query_seq.fasta
    param.--type: assembly
  make_reference_fasta:
    # create reference fasta data
    param.command: $;BIN_DIR$;/bsml2fasta
    param.--bsml_list: "'$;REFERENCE_BSML_FILE_LIST$;'"
    param.--output: $;TMP_DIR$;/$;REF_ASMBL_ID$;.fasta
    param.--type: assembly
  mgaps:
    param.command: /usr/local/common/mgaps
    arg: -l $;MGAPS_MINIMUM_CLUSTER_MATCH_LENGTH$;
    arg: -f $;MGAPS_FRACTIONAL_DIAGONAL_DISTANCE$;
    arg: -s $;MGAPS_MAXIMUM_SEPERATION_BETWEEN_CLUSTERS$;
    param.stdin: $;TMP_DIR$;/mums.out
    param.stdout: $;TMP_DIR$;/mums.gaps
  mummer:
    # Mummer Analysis (these three steps are equivalent to the run-mummer3 shell script)
    param.command: /usr/local/common/mummer
    arg: -mumcand
    arg: -b
    arg: -l $;MUMMER_MIMIMUM_MATCH_LENGTH$;
    arg: $;TMP_DIR$;/$;REF_ASMBL_ID$;.fasta
    arg: $;TMP_DIR$;/tile.tiled_asmbl.fasta
    param.stdout: $;TMP_DIR$;/mums.out
  nucmer:
    # run nucmer
    param.command: /usr/local/common/nucmer
    arg: -p $;TMP_DIR$;/nucmer
    arg: $;TMP_DIR$;/$;REF_ASMBL_ID$;.fasta
    arg: $;TMP_DIR$;/query_seq.fasta
  set_output_permissions:
    # give global read/write access to the output files
    param.command: find
    arg: $;OUTPUT_DIRECTORY$;
    arg: "-type f ! -regex '.*/\\..*' -exec chmod \\{\\} -R 666 \\;"
  set_scratch_permissions:
    # give global read/write access to the scratch files
    param.command: find
    arg: $;TMP_DIR$;
    arg: "-type f ! -regex '.*/\\..*' -exec chmod \\{\\} -R 666 \\;"
  set_workflowdocs_permissions:
    param.command: find
    arg: $;WORKFLOW_REPOSITORY$;
    arg: "-type f ! -regex '.*/\\..*' -exec chmod 666 \\{\\} \\;"
  show_tiling:
    # run show tiling
    param.command: /usr/local/common/show-tiling
    arg: -c
    arg: -v $;TILING_COVERAGE_THRESHOLD$;
    arg: -g $;TILING_MAXIMUM_GAP$;
    arg: $;TMP_DIR$;/nucmer.delta
    param.stdout: $;TMP_DIR$;/tiling.txt
  snp_extract_fasta:
    # prepare tiled assemblies for mummer and reverse compliment the
    # data as appropriate
    param.command: $;BIN_DIR$;/SNP_ExtractFASTA.pl
    arg: $;TMP_DIR$;/tiling.txt
    arg: $;TMP_DIR$;/query_seq.fasta
    arg: $;TMP_DIR$;/tile;
  store_config_parameters:
    # store parameters associated with analysis in bsml file
    # workflow will pass add'l optional parameters if invoked with LoggedUnixCommand
    # --command-id
    param.command: $;BIN_DIR$;/analysis2bsml
    param.--ergatis_control_file: $;ERGATIS_DIR$;.ini
    param.--conf: $;COMPONENT_CONFIG$;
    param.--bsml_file: $;OUTPUT_DIRECTORY$;/$;REF_ASMBL_ID$;_$;NAME$;_$;WFID$;.bsml

# Workflow INI: snpconf.ini
workflow_ini_snpconf.ini:
  _header:
    # configuration file for the snps workflow
  include snps:
    $;SHARED_CONFIG$;: $;WORKFLOWDOCS_DIR$;/sharedconf.ini
  input snps:
    $;QUERY_BSML_FILE_LIST$;: ""
    $;REFERENCE_BSML_FILE_LIST$;: ""
    $;REF_ASMBL_ID$;: ""
  output snps:
    $;OUTPUT_DIRECTORY$;: $;REPOSITORY_ROOT$;/BSML_repository/$;NAME$;
  parameters snps:
    $;TILING_COVERAGE_THRESHOLD$;: 80
    $;TILING_MAXIMUM_GAP$;: -1
    $;MUMMER_MIMIMUM_MATCH_LENGTH$;: 20
    $;MGAPS_MINIMUM_CLUSTER_MATCH_LENGTH$;: 100
    $;MGAPS_FRACTIONAL_DIAGONAL_DISTANCE$;: .12
    $;MGAPS_MAXIMUM_SEPERATION_BETWEEN_CLUSTERS$;: 600
    $;COMBINE_MUMS_ERROR_CUTOFF$;: .10
  workflowdocs snps:
    # The version here is set by an interpolated CVS tag
    $;VERSION$;: $Name$
    $;REVISION$;: $Revision$
    $;TAG$;: $Name$
    $;NAME$;: snps
    $;MASTER_TEMPLATE_INI$;: $;WORKFLOWDOCS_DIR$;/snp-master.ini
    $;MASTER_TEMPLATE_XML$;: $;WORKFLOWDOCS_DIR$;/snp-master_template.xml
    $;WORKFLOW_REPOSITORY$;: $;REPOSITORY_ROOT$;/Workflow/$;NAME$;/$;PIPELINEID$;_$;OUTPUT_TOKEN$;
    $;GROUP_COUNT$;: 400
    # the following keys are replaced at runtime by the invocation script
    $;COMPONENT_CONFIG$;: ""
    $;NODISTRIB$;: 0
