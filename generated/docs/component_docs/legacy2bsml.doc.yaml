---
# Ergatis Component Documentation
# Extracted from source by extract_component_docs.pl
# Source: TIGR/JCVI/IGS Ergatis bioinformatics workflow system
#
# This file preserves ALL documentation, comments, parameter descriptions,
# and structural details from the original Ergatis source files.

component: legacy2bsml
extracted_at: "2026-02-19T15:39:25"
source_files:
  - legacy2bsml.config
  - legacy2bsml.xml
  - legacy2bsml.i1.xml
  - workflow/legacy2bsml-master.ini
  - workflow/legacy2bsml.ini
  - workflow/legacy2bsmlconf.ini

# Configuration file - all sections, parameters, defaults, and inline comments
config:
  interface:
    classification: database / extraction
  parameters:
    USERNAME: access
    PASSWORD: access
    # PLEASE NOTE: the capitalization of the rdbms parameter MUST match the name of the corresponding Prism module (e.g., "Sybase" or "Mysql", not "sybase" or "mysql")
    RDBMS: Sybase
    HOST: SYBTIGR
    # Mode:
    # 1 = produce only gene models 
    # 2 = produce gene models and extract legacy computational analyses 
    # 3 = only extract legacy computational analyses
    MODE: 2
    # The IdGenerator identifier version value to be appended to the sequence and feature identifiers
    IDGEN_IDENTIFIER_VERSION: 0
    # email:
    # Valid EMAIL values are comma-separated list of TIGR UNIX email accounts with or without the @tigr.org suffix 
    # and even other external fully qualified accounts e.g. youraddress@someplace.com
    EMAIL: ""
    NO_DIE_NULL_SEQUENCES: 1
    BSML_DTD: $;DOCS_DIR$;/bsml3_1.dtd
    # 
    # ID mapping input directories is a comma-separated list of directories which may contain ID mapping files
    # that have file extension .idmap.  These files's contents will be loaded into the ID mapping lookup.
    # The ID mapping scheme is how we ensure consistent naming of features/sequences coming out of the legacy
    # annotation databases and being written to BSML.
    # Note that each and every instance of legacy2bsml.pl launched by this workflow will scan the directories
    # and each will load the ID mappings into their own hash lookups.
    INPUT_ID_MAPPING_DIRECTORIES: ""
    # 
    # ID mapping input file is a comma-separated list of files with .idmap file extensions.  The files'
    # contents will be loaded into the ID mapping lookup.
    # Note that each and every instance of legacy2bsml.pl launched by this workflow will read in all of the
    # ID mapping files specified here and each will load the ID mappings into their own hash lookups.
    INPUT_ID_MAPPING_FILES: ""
  input:
    # legacy2bsml control file:
    # Should contain a listing of organisms and corresponding asmbl_ids, organism_types, sequence_types.  
    # Please see bugzilla case 2557 for a complete description.
    LEGACY2BSML_CONTROL_FILE: ""
  output:
    OUTPUT_TOKEN: default
    OUTPUT_DIRECTORY: $;REPOSITORY_ROOT$;/output_repository/$;COMPONENT_NAME$;/$;PIPELINEID$;_$;OUTPUT_TOKEN$;
    FASTA_DIRECTORY: $;OUTPUT_DIRECTORY$;/fasta
    BSML_OUTPUT_LIST: $;OUTPUT_DIRECTORY$;/$;COMPONENT_NAME$;.bsml.list
    FASTA_OUTPUT_LIST: $;OUTPUT_DIRECTORY$;/$;COMPONENT_NAME$;.fsa.list
  component:
    COMPONENT_NAME: legacy2bsml
    DESCRIPTION: none
    WORKFLOW_REPOSITORY: $;REPOSITORY_ROOT$;/workflow/runtime/$;COMPONENT_NAME$;/$;PIPELINEID$;_$;OUTPUT_TOKEN$;
    PIPELINE_TOKEN: unnamed
    # The version,revision,tag here is set by an interpolated CVS tag
    VERSION: 2.0
    RELEASE_TAG: $Name$
    REVISION: $Revision$
    TEMPLATE_XML: $;DOCS_DIR$;/$;COMPONENT_NAME$;.xml
    ITERATOR1: i1
    ITERATOR1_XML: $;DOCS_DIR$;/$;COMPONENT_NAME$;.$;ITERATOR1$;.xml
    # Distributed options
    GROUP_COUNT: 50
    NODISTRIB: 0
    # the following keys are replaced at runtime by the invocation script
    COMPONENT_CONFIG: ""
    COMPONENT_XML: ""
    PIPELINE_XML: ""
    PIPELINEID: ""
  include:
    PROJECT_CONFIG: ""

# Main workflow XML template - step definitions
workflow_xml:
  xml_comments:
    - Preprocessing
  command_sets:
    - legacy2bsml workflow
  includes:
    - "file=\"$;DOCS_DIR$;/iterator_template.xml\" keys=\"$;ITERATOR_NAME$;=ITERATOR1,$;ITERATOR_XML$;=ITERATOR1_XML,$;ITERATOR_LIST$;=$;TMP_DIR$;/legacy2bsml.list\"/"
  steps:
    - name: create output directories
      type: RunUnixCommand
      executable: mkdir
      arg: -p -m 777 $;OUTPUT_DIRECTORY$; $;TMP_DIR$; $;TMP_DIR$;/id_mapping
    - name: Create legacy2bsml master iterator list file
      type: RunUnixCommand
      executable: $;BIN_DIR$;/create_legacy2bsml_iterator_list
      params:
        - key: --control_file
          value: $;LEGACY2BSML_CONTROL_FILE$;
        - key: --output
          value: $;TMP_DIR$;/legacy2bsml.list
        - key: stdout
          value: $;TMP_DIR$;/create_legacy2bsml_iterator_list.stdout
        - key: stderr
          value: $;TMP_DIR$;/create_legacy2bsml_iterator_list.stderr
    - name: Create BSML file list
      type: RunJavaUnixCommand
      executable: find
      arg: "$;OUTPUT_DIRECTORY$; -name '*.bsml'"
      params:
        - key: stdout
          value: $;BSML_OUTPUT_LIST$;
        - key: stderr
          value: $;TMP_DIR$;/create_bsml_file_list.stderr
    - name: Create FASTA file list
      type: RunJavaUnixCommand
      executable: find
      arg: "$;FASTA_DIRECTORY$; -name '*.fsa'"
      params:
        - key: stdout
          value: $;FASTA_OUTPUT_LIST$;
        - key: stderr
          value: $;TMP_DIR$;/create_legacy2bsml_iterator_list.stderr
    - name: Consolidate all .idmap files
      type: RunUnixCommand
      executable: $;BIN_DIR$;/consolidateIdMapFiles
      params:
        - key: --input_directories
          value: $;TMP_DIR$;/id_mapping
        - key: --output_file
          value: $;REPOSITORY_ROOT$;/workflow/mapping/$;PIPELINEID$;_$;COMPONENT_NAME$;_$;OUTPUT_TOKEN$;.idmap
        - key: --logfile
          value: $;OUTPUT_DIRECTORY$;/consolidateIdMapFiles.pl.log
        - key: stdout
          value: $;OUTPUT_DIRECTORY$;/consolidateIdMapFiles.pl.stdout
        - key: stderr
          value: $;OUTPUT_DIRECTORY$;/consolidateIdMapFiles.pl.stderr

# Iterator i1 - per-input processing steps
iterator_i1:
  command_sets:
    - legacy2bsml
  steps:
    - name: Create the FASTA output directory
      type: RunUnixCommand
      executable: mkdir
      arg: -p -m 777 $;FASTA_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/
    - name: legacy2bsml
      type: RunUnixCommand
      executable: $;BIN_DIR$;/legacy2bsml
      params:
        - key: --database
          value: $;DATABASE$;
        - key: --password
          value: $;PASSWORD$;
        - key: --username
          value: $;USERNAME$;
        - key: --host
          value: $;HOST$;
        - key: --rdbms
          value: $;RDBMS$;
        - key: --mode
          value: $;MODE$;
        - key: --bsml_doc_name
          value: $;OUTPUT_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;DATABASE$;_$;ASMBL_ID$;_assembly.$;SCHEMA_TYPE$;.bsml
        - key: --log4perl
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.legacy2bsml.pl.log
        - key: --debug_level
          value: $;DEBUG$;
        - key: --fastadir
          value: $;FASTA_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/
        - key: --asmbl_id
          value: $;ASMBL_ID$;
        - key: --schema_type
          value: $;SCHEMA_TYPE$;
        - key: --sequence_type
          value: $;SEQUENCE_TYPE$;
        - key: --exclude_genefinders
          value: $;EXCLUDE_GENEFINDERS$;
        - key: --include_genefinders
          value: $;INCLUDE_GENEFINDERS$;
        - key: --alt_database
          value: $;ALT_DATABASE$;
        - key: --alt_species
          value: $;ALT_SPECIES$;
        - key: --id_repository
          value: $;PROJECT_ID_REPOSITORY$;
        - key: --input_id_mapping_directories
          value: "'$;INPUT_ID_MAPPING_DIRECTORIES$;'"
        - key: --input_id_mapping_files
          value: "'$;INPUT_ID_MAPPING_FILES$;'"
        - key: --output_id_mapping_file
          value: $;TMP_DIR$;/id_mapping/$;DATABASE$;_$;ASMBL_ID$;_$;SCHEMA_TYPE$;.idmap
        - key: --idgen_identifier_version
          value: $;IDGEN_IDENTIFIER_VERSION$;
        - key: --tu_list_file
          value: $;TU_LIST_FILE$;
        - key: --model_list_file
          value: $;MODEL_LIST_FILE$;
        - key: --no_die_null_sequences
          value: $;NO_DIE_NULL_SEQUENCES$;
        - key: --sourcename
          value: $;OUTPUT_DIRECTORY$;
        - key: stdout
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/legacy2bsml.$;DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.stdout
        - key: stderr
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/legacy2bsml.$;DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.stderr
    - name: DTD validation
      type: RunUnixCommand
      executable: $;BIN_DIR$;/dtdValid.pl
      arg: -d $;BSML_DTD$; $;OUTPUT_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;DATABASE$;_$;ASMBL_ID$;_assembly.$;SCHEMA_TYPE$;.bsml
    - name: profileBSMLFile
      type: RunUnixCommand
      executable: $;BIN_DIR$;/profileBSMLFile
      params:
        - key: --infile
          value: $;OUTPUT_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;DATABASE$;_$;ASMBL_ID$;_assembly.$;SCHEMA_TYPE$;.bsml
        - key: --database
          value: $;DATABASE$;
        - key: --asmbl_id
          value: $;ASMBL_ID$;
        - key: --logfile
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.profileBSMLFile.pl.log
        - key: stdout
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/profileBSMLFile.$;DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.stdout
        - key: stderr
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/profileBSMLFile.$;DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.stderr

# Workflow INI: legacy2bsml-master.ini
workflow_ini_legacy2bsml-master.ini:
  _header:
    # -------------------------------------------------------------------------------------
    # 
    # Component: legacy2bsml
    # 
    # Author:    Jay Sundaram sundaram@tigr.org
    # 
    # Date:      2005.07.22
    # 
    # Purpose:   This component will migrate the sequences, features and associated
    # annotation from the specified legacy annotation databases e.g. gba (prok)
    # or bma1 (euk)- to produce bsml gene model encodings.
    # 
    # 
    # 
    # Version:  $Id$
    # 
    # CVS:      ergatis/workflow/legacy2bsml/legacy2bsml-master.ini
    # 
    # Online:   http://sundaram-lx:8080/instructions/legacy2bsml.html
    # 
    # 
    # -------------------------------------------------------------------------------------
  create_bsml_list_file:
    param.command: find
    arg: "$;OUTPUT_DIRECTORY$; -name '*.bsml'"
    param.stdout: $;OUTPUT_DIRECTORY$;/$;NAME$;.bsml.list
  create_compute_output:
    # make the output directory
    param.command: mkdir
    arg: -p -m 777 $;OUTPUT_DIRECTORY$;
  create_compute_scratch:
    # make the scratch space
    param.command: mkdir
    arg: -p -m 777 $;TMP_DIR$;
  create_fasta_list_file:
    param.command: find
    arg: "$;FASTA_DIRECTORY$; -name '*.fsa'"
    param.stdout: $;FASTA_DIRECTORY$;/$;NAME$;.fsa.list
  create_fastadir:
    # make the fasta directory
    param.command: mkdir
    arg: -p -m 777 $;FASTA_DIRECTORY$;
  create_groups_subflow1:
    param.command: $;BIN_DIR$;/generate_groups
    param.output_dir: $;WORKFLOW_REPOSITORY$;
    param.prefix: subflow1groups
    param.group_count: $;GROUP_COUNT$;
    param.file: $;WORKFLOW_REPOSITORY$;/subflow1.list
  create_iterative_subflow1:
    # create iterative subflow
    param.command: $;BIN_DIR$;/generate_subflow
    # workflow doc information
    param.template: $;WORKFLOWDOCS_DIR$;/groups-iterator_template.xml
    param.inifile: $;WORKFLOWDOCS_DIR$;/groups-iterator.ini
    param.iteratortemplate: $;WORKFLOWDOCS_DIR$;/batch-paralleliterator_template.xml
    param.iteratorini: $;WORKFLOWDOCS_DIR$;/batch-iterator.ini
    param.iteratorlist: $;WORKFLOW_REPOSITORY$;/subflow1groups.list
    param.conf: $;COMPONENT_CONFIG$;
    param.wfname: $;NAME$;
    param.nodistrib: $;NODISTRIB$;
    # output information
    param.outputdir: $;WORKFLOW_REPOSITORY$;
    param.outputxml: $;WORKFLOW_REPOSITORY$;/groups.xml
    param.debug: $;DEBUG$;
  create_iterator_list_subflow1:
    param.command: $;BIN_DIR$;/generate_legacy2bsml_list
    param.control_file: $;LEGACY2BSML_CONTROL_FILE$;
    param.output: $;WORKFLOW_REPOSITORY$;/subflow1.list
  empty:
  subflow1:
    fileName: $;WORKFLOW_REPOSITORY$;/groups.xml

# Workflow INI: legacy2bsml.ini
workflow_ini_legacy2bsml.ini:
  dtd_validation:
    # Perform DTD validation on the output BSML gene model document in previous step
    param.command: $;BIN_DIR$;/dtdValid.pl
    param.dtd: $;SCHEMA_DIR$;/bsml3_1.dtd
    arg: $;OUTPUT_DIRECTORY$;/$;SOURCE_DATABASE$;_$;ASMBL_ID$;_assembly.$;SCHEMA_TYPE$;.bsml
  empty:
  legacy2bsml:
    # Generate gene model BSML documents and associated FASTA files
    param.command: $;BIN_DIR$;/legacy2bsml
    param.--username: $;USERNAME$;
    param.--password: $;PASSWORD$;
    param.--database: $;SOURCE_DATABASE$;
    param.--mode: $;MODE$;
    param.--log4perl: $;WORKFLOW_REPOSITORY$;/legacy2bsml.$;SOURCE_DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.log
    param.--debug_level: $;DEBUG$;
    param.--outdir: $;OUTPUT_DIRECTORY$;
    param.--fastadir: $;FASTA_DIRECTORY$;
    param.--asmbl_id: $;ASMBL_ID$;
    param.--schema_type: $;SCHEMA_TYPE$;
    param.--sequence_type: $;SEQUENCE_TYPE$;
    param.--exclude_genefinders: $;EXCLUDE_GENEFINDERS$;
    param.--include_genefinders: $;INCLUDE_GENEFINDERS$;
    param.--alt_database: $;ALT_DATABASE$;
    param.--alt_species: $;ALT_SPECIES$;
    param.--id_repository: $;PROJECT_ID_REPOSITORY$;
    param.--tu_list_file: $;TU_LIST_FILE$;
    param.--model_list_file: $;MODEL_LIST_FILE$;
    param.--project: $;DATABASE$;
    param.--no_die_null_sequences: $;NO_DIE_NULL_SEQUENCES$;
    param.stdout: $;TMP_DIR$;/legacy2bsml.$;SOURCE_DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.stdout
    param.stderr: $;TMP_DIR$;/legacy2bsml.$;SOURCE_DATABASE$;.$;ASMBL_ID$;.$;SCHEMA_TYPE$;.stderr

# Workflow INI: legacy2bsmlconf.ini
workflow_ini_legacy2bsmlconf.ini:
  _header:
    # configuration file for the legacy2bsml workflow
  include legacy2bsml:
    $;SHARED_CONFIG$;: ""
  output legacy2bsml:
    $;OUTPUT_TOKEN$;: default
    $;OUTPUT_DIRECTORY$;: $;REPOSITORY_ROOT$;/output_repository/$;NAME$;/$;PIPELINEID$;_$;OUTPUT_TOKEN$;
    $;FASTA_DIRECTORY$;: $;OUTPUT_DIRECTORY$;/fasta
  parameters legacy2bsml:
    # For detailed instructions: http://sundaram-lx:8080/components/legacy2bsml.html
    # Sybase user login name
    $;USERNAME$;: access
    # Sybase user password
    $;PASSWORD$;: access
    # 1=> produce only gene models 2=> produce gene models and extract legacy computational analyses 3=> only extract legacy computational analyses
    $;MODE$;: 2
    # File containing listing of organisms and corresponding asmbl_ids, organism_types, sequence_types.  See bugzilla case 2557 for details.
    $;LEGACY2BSML_CONTROL_FILE$;: ""
    # SYBTIGR or SYBIL (Sybase server from which legacy annotation should be drawn)
    $;SERVER$;: SYBTIGR
    # Valid EMAIL values are comma-separated list of TIGR UNIX email accounts with or without the @tigr.org suffix and even other external fully qualified accounts e.g. youraddress@someplace.com
    $;EMAIL$;: ""
    $;NO_DIE_NULL_SEQUENCES$;: 1
  workflowdocs legacy2bsml:
    # The version here is set by an interpolated CVS tag
    $;VERSION$;: $Name$
    $;REVISION$;: $Revision$
    $;TAG$;: $Name$
    $;NAME$;: legacy2bsml
    $;MASTER_TEMPLATE_INI$;: $;WORKFLOWDOCS_DIR$;/legacy2bsml-master.ini
    $;MASTER_TEMPLATE_XML$;: $;WORKFLOWDOCS_DIR$;/legacy2bsml-master_template.xml
    $;TEMPLATE_INI$;: $;WORKFLOWDOCS_DIR$;/legacy2bsml.ini
    $;TEMPLATE_XML$;: $;WORKFLOWDOCS_DIR$;/legacy2bsml_template.xml
    $;WORKFLOW_REPOSITORY$;: $;REPOSITORY_ROOT$;/Workflow/$;NAME$;/$;PIPELINEID$;_$;OUTPUT_TOKEN$;
    $;GROUP_COUNT$;: 5
    # the following keys are replaced at runtime by the invocation script
    $;COMPONENT_CONFIG$;: ""
    $;NODISTRIB$;: 0

# Perl script documentation (POD)
perl_scripts:
  - script: create_legacy2bsml_iterator_list.pl
    pod: |
  =head1  NAME 
  
  generate_asmbl_list.pl - Default output is a workflow iterator that
  can be used to iterator over a set of asmbl_ids
  
  =head1 SYNOPSIS
  
  USAGE:  generate_asmbl_list
  
  =head1 OPTIONS
  
  =item *
  
  B<--debug,-d> Debug level.  Use a large number to turn on verbose debugging. 
  
  =item *
  
  B<--log,-l> Log file
  
  =item *
  
  B<--help,-h> This help message
  
  =head1   DESCRIPTION
