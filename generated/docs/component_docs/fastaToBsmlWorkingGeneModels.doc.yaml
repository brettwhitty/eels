---
# Ergatis Component Documentation
# Extracted from source by extract_component_docs.pl
# Source: TIGR/JCVI/IGS Ergatis bioinformatics workflow system
#
# This file preserves ALL documentation, comments, parameter descriptions,
# and structural details from the original Ergatis source files.

component: fastaToBsmlWorkingGeneModels
extracted_at: "2026-02-19T15:34:47"
source_files:
  - fastaToBsmlWorkingGeneModels.config
  - fastaToBsmlWorkingGeneModels.xml
  - fastaToBsmlWorkingGeneModels.i1.xml

# Configuration file - all sections, parameters, defaults, and inline comments
config:
  interface:
    classification: file / conversion
  parameters:
    DATABASE: $;PROJECT$;
    # The following is the input list file that should contain a new-line
    # separated list of gene prediction multi-FASTA files.  This is required
    # for generating the iterator list file which will drive the process.
    INPUT_FASTA_LIST_FILE: ""
    # The following is the input list file that should contain a new-line
    # separated list of BSML files that were generated by the glk2bsml
    # software.  This is required for generating the iterator list file 
    # which will drive the process.
    INPUT_BSML_LIST_FILE: ""
  input:
    # the following is only used when iterating over an INPUT_DIRECTORY
    INPUT_EXTENSION: fsa
  output:
    OUTPUT_TOKEN: default
    OUTPUT_DIRECTORY: $;REPOSITORY_ROOT$;/output_repository/$;COMPONENT_NAME$;/$;PIPELINEID$;_$;OUTPUT_TOKEN$;
  component:
    COMPONENT_NAME: fastaToBsmlWorkingGeneModels
    DESCRIPTION: none
    WORKFLOW_REPOSITORY: $;REPOSITORY_ROOT$;/workflow/runtime/$;COMPONENT_NAME$;/$;PIPELINEID$;_$;OUTPUT_TOKEN$;
    PIPELINE_TOKEN: unnamed
    # The version,revision,tag here is set by an interpolated CVS tag
    VERSION: 2.0
    RELEASE_TAG: "$Name:  $"
    REVISION: "$Revision: 1.1 $"
    TEMPLATE_XML: $;DOCS_DIR$;/$;COMPONENT_NAME$;.xml
    ITERATOR1: i1
    ITERATOR1_XML: $;DOCS_DIR$;/$;COMPONENT_NAME$;.$;ITERATOR1$;.xml
    FASTA_DIRECTORY: $;OUTPUT_DIRECTORY$;/fasta
    BSML_OUTPUT_LIST: $;OUTPUT_DIRECTORY$;/$;COMPONENT_NAME$;.bsml.list
    FASTA_OUTPUT_LIST: $;OUTPUT_DIRECTORY$;/$;COMPONENT_NAME$;.fsa.list
    BSML_DTD: $;DOCS_DIR$;/bsml3_1.dtd
    # Distributed options
    GROUP_COUNT: 150
    NODISTRIB: 0
    # the following keys are replaced at runtime by the invocation script
    COMPONENT_CONFIG: ""
    COMPONENT_XML: ""
    PIPELINE_XML: ""
    PIPELINEID: ""
  include:
    PROJECT_CONFIG: ""

# Main workflow XML template - step definitions
workflow_xml:
  xml_comments:
    - Preprocessing
  command_sets:
    - fastaToBsmlWorkingGeneModels workflow
  includes:
    - "file=\"$;DOCS_DIR$;/iterator_template.xml\" keys=\"$;ITERATOR_NAME$;=ITERATOR1,$;ITERATOR_XML$;=ITERATOR1_XML,$;ITERATOR_LIST$;=$;TMP_DIR$;/fastaToBsmlWorkingGeneModels.list\"/"
  steps:
    - name: create output and temp directories
      type: RunUnixCommand
      executable: mkdir
      arg: -p -m 777 $;OUTPUT_DIRECTORY$; $;TMP_DIR$;
    - name: Create fastaToBsmlWorkingGeneModels master iterator list file
      type: RunUnixCommand
      executable: $;BIN_DIR$;/createAsmblIdToBsmlIdMappingFile
      params:
        - key: --fsalistfile
          value: $;INPUT_FASTA_LIST_FILE$;
        - key: --bsmllistfile
          value: $;INPUT_BSML_LIST_FILE$;
        - key: --outfile
          value: $;TMP_DIR$;/fastaToBsmlWorkingGeneModels.list
        - key: --logfile
          value: $;TMP_DIR$;/createAsmblIdToBsmlIdMappingFile.pl.log
        - key: stdout
          value: $;TMP_DIR$;/createAsmblIdToBsmlIdMappingFile.pl.stdout
        - key: stderr
          value: $;TMP_DIR$;/createAsmblIdToBsmlIdMappingFile.pl.stderr
    - name: Create BSML file list
      type: RunJavaUnixCommand
      executable: find
      arg: "$;OUTPUT_DIRECTORY$; -name '*.bsml'"
      params:
        - key: stdout
          value: $;BSML_OUTPUT_LIST$;
        - key: stderr
          value: $;TMP_DIR$;/create_bsml_file_list.stderr
    - name: Create FASTA file list
      type: RunJavaUnixCommand
      executable: find
      arg: "$;FASTA_DIRECTORY$; -name '*.fsa'"
      params:
        - key: stdout
          value: $;FASTA_OUTPUT_LIST$;
        - key: stderr
          value: $;TMP_DIR$;/create_fastaToBsmlWorkingGeneModels_iterator_list.stderr

# Iterator i1 - per-input processing steps
iterator_i1:
  command_sets:
    - fastaToBsmlWorkingGeneModels
  steps:
    - name: Create the FASTA output directory
      type: RunUnixCommand
      executable: mkdir
      arg: -p -m 777 $;FASTA_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/
    - name: fastaToBsmlWorkingGeneModels
      type: RunUnixCommand
      executable: $;BIN_DIR$;/fastaToBsmlWorkingGeneModels
      params:
        - key: --database
          value: $;DATABASE$;
        - key: --sequenceId
          value: $;SEQUENCE_ID$;
        - key: --infile
          value: $;INPUT_FASTA_FILE$;
        - key: --outfile
          value: $;OUTPUT_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;SEQUENCE_ID$;.bsml
        - key: --logfile
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;SEQUENCE_ID$;.fastaToBsmlWorkingGeneModels.pl.log
        - key: --debug_level
          value: $;DEBUG$;
        - key: --genus
          value: $;GENUS$;
        - key: --species
          value: "'$;SPECIES$;'"
        - key: --id-repository
          value: $;PROJECT_ID_REPOSITORY$;
        - key: stdout
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/fastaToBsmlWorkingGeneModels.$;SEQUENCE_ID$;.stdout
        - key: stderr
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/fastaToBsmlWorkingGeneModels.$;SEQUENCE_ID$;.stderr
    - name: DTD validation
      type: RunUnixCommand
      executable: $;BIN_DIR$;/dtdValid.pl
      arg: -d $;BSML_DTD$; $;OUTPUT_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;SEQUENCE_ID$;.bsml
    - name: profileBSMLFile
      type: RunUnixCommand
      executable: $;BIN_DIR$;/profileBSMLFile
      params:
        - key: --infile
          value: $;OUTPUT_DIRECTORY$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;SEQUENCE_ID$;.bsml
        - key: --database
          value: $;DATABASE$;
        - key: --asmbl_id
          value: $;SEQUENCE_ID$;
        - key: --logfile
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/$;SEQUENCE_ID$;.profileBSMLFile.pl.log
        - key: stdout
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/profileBSMLFile.$;SEQUENCE_ID$;.stdout
        - key: stderr
          value: $;TMP_DIR$;/$;ITERATOR_NAME$;/g$;GROUP_NUMBER$;/profileBSMLFile.$;SEQUENCE_ID$;.stderr
